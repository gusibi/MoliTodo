# 悬浮任务功能说明

## 功能概述
悬浮任务功能允许用户将任务面板中的任务创建为独立的悬浮窗口，方便在桌面上进行任务管理。

## 使用方法

### 创建悬浮任务
1. 在任务面板中，右键点击任何一个任务
2. 在弹出的右键菜单中选择"创建悬浮任务"
3. 系统会创建一个独立的悬浮窗口显示该任务

### 悬浮任务功能
悬浮任务窗口包含以下功能：
- **任务标题显示**：显示任务的完整内容
- **复选框**：点击复选框可以快速标记任务完成/未完成
- **状态标签**：显示任务当前状态（待办/进行中/暂停中/已完成）
- **实时计时**：当任务处于"进行中"状态时，显示实时计时
- **操作按钮**：开始、暂停、继续、完成、重新开始等操作
- **提醒时间**：如果设置了提醒时间，会显示提醒标签
- **拖拽移动**：通过拖拽整个窗口可以移动位置
- **关闭窗口**：点击右上角的红色关闭按钮

### 窗口特性
- **置顶显示**：悬浮任务窗口始终保持在其他窗口之上
- **半透明背景**：窗口具有半透明的毛玻璃效果，看起来像卡片放在透明背景上
- **TaskItem样式**：使用与主界面任务项相同的设计风格
- **自动定位**：新创建的悬浮任务会随机定位，避免重叠
- **独立管理**：每个任务的悬浮窗口都是独立的，可以同时存在多个

## 技术实现

### 架构设计
- 悬浮任务使用独立的窗口管理系统，不与悬浮图标共享window manager
- 使用Electron的原生拖拽功能(`-webkit-app-region`)实现窗口拖拽
- 通过Vue Router实现悬浮任务页面路由

### 文件结构
```
src/renderer/src/components/float_view/FloatingTask.vue - 悬浮任务组件
src/renderer/src/assets/styles/components/floating-task.css - 悬浮任务样式
src/main/window-manager.js - 窗口管理（包含悬浮任务窗口创建）
src/main/ipc-handlers.js - IPC处理程序
src/main/preload.js - 预加载脚本API
```

### 关键特性
1. **独立窗口系统**：悬浮任务使用`floatingTaskWindows` Map管理，与主悬浮图标分离
2. **原生拖拽**：使用CSS的`-webkit-app-region: drag`实现拖拽，无需复杂的JavaScript拖拽逻辑
3. **实时同步**：悬浮任务与主任务数据实时同步，状态变更会立即反映
4. **资源管理**：窗口关闭时自动清理资源，避免内存泄漏

## 注意事项
- 同一个任务只能创建一个悬浮窗口，重复创建会聚焦现有窗口
- 悬浮任务窗口会在应用退出时自动关闭
- 任务数据的变更会实时同步到所有相关窗口